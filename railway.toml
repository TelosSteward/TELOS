# Railway configuration for TELOS Observatory
# This downloads SentenceTransformer models during BUILD phase (not startup)
# so they're baked into the container image for instant availability.

[build]
# Run pip install first, then download models
builder = "NIXPACKS"
buildCommand = "pip install -r requirements.txt && python3 -c \"from sentence_transformers import SentenceTransformer; SentenceTransformer('sentence-transformers/all-MiniLM-L6-v2'); SentenceTransformer('sentence-transformers/all-mpnet-base-v2'); print('Models cached!')\""

[deploy]
# Use the Procfile for the start command
startCommand = "streamlit run telos_observatory_v3/main.py --server.port $PORT --server.address 0.0.0.0"
healthcheckPath = "/"
healthcheckTimeout = 300
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3
